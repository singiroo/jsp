<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd">
	
	<!-- 1. datasource : connection pool
	     2. SqlSessionFactoryBean : datasource를 이용하여 mybatis 설정을 담당 
	     3. SqlSessionTemplate : sqlSessionFactory 객체로부터 생성하며 mybatis를 통해 sql을 실행할 수 있는 객체(sqlSession)
	 -->
	
	
	<!-- db 연결 정보를 저장하고 있는 properties 파일  -->
	<context:property-placeholder location="classpath:kr/or/ddit/config/db/db.properties"/>
	
	
	<!-- db 연결 정보를 바탕으로 dataSource(connection pool) 빈 등록  -->
	<bean id="dataSource" class="org.apache.commons.dbcp2.BasicDataSource">
		<property name="url" value="${jdbc.url}"/>
		<property name="driverClassName" value="${jdbc.driver}"/>
		<property name="username" value="${jdbc.username}"/>
		<property name="password" value="${jdbc.password}"/>
	</bean>
	
	<!-- MybatisUtil 역할을 함.
	     sqlSession을 생성하는 fatory 객체 bean 등록
	     sqlSession을 생성하기 위해서 db연결 정보와 mybatis 설정 정보(mapper 정보, typeAlias 정보 등) 필요  -->
	     
	<!-- SqlSessionFactoryBean 객체는 객체를 생성하는 역할을 담당하는 객체
	     스프링 프레임워크는 스프링 빈을 생성시 객체가 FactoryBean 인터페이스를 구현한 경우
	     인터페이스에 정의되어 있는 getObject() 메소드가 리턴하는 객체를 스프링 빈으로 등록한다.  -->     
	<bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
		<!-- mybatis 설정 정보  -->
		<property name="configLocation" value="classpath:kr/or/ddit/config/db/mybatis-config.xml"/>
		<!-- dataSource 빈 참조  -->
		<property name="dataSource" ref="dataSource"/>
	</bean>
	
	<!-- sqlSessionTemplate 빈
	     sqlSessionTemplate의 생성자 중에 sqlSessionFactory를 인자로 필요로하는 것이 존재
	     constructor injection을 이용하여 주입  -->
	<bean id="sqlSessionTemplate" class="org.mybatis.spring.SqlSessionTemplate">
		<!--  -->
		<constructor-arg ref="sqlSessionFactory"/>
	</bean>
		
	

</beans>
